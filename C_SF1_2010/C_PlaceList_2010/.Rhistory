# Download data
fileUrl <- "http://www.census.gov/geo/reference/codes/files/national_places.txt"
download.file(fileUrl, destfile="national_places.txt", method="curl")
dateDownloaded <- date()
write(dateDownloaded,file="national_places.txt.date.txt")
placelist <- read.csv("national_places.txt.date.txt", sep="|")
head(placelist)
placelist <- read.csv("national_places.txt", sep="|", header = TRUE)
head(placelist)
placelist <- read.csv("national_places.txt", sep="|", header = TRUE, colClasses="character")
head(placelist)
colnames(placelist) <-  tolower(names(placelist))
head(placelist)
nrow(placelist)
butLast <- function(x){head(x, -1)}
placelist$countyname <- sapply(sapply(strsplit(placelist$county," "), butLast), paste)
warnings()
head(placelist$countyname)
head(placelist)
countynameslist <- sapply(strsplit(placelist$county," "), butLast)
head(countynameslist)
placelist$countyname <- sapply(countynameslist , paste, sep=" ")
head(placelist)
tail(placelist)
warnings()
change locale
Sys.setlocale("LC_ALL", 'en_US.UTF-8')
Sys.setlocale("LC_ALL", 'en_US.UTF-8')
placelist <- read.csv("national_places.txt", sep="|", header = TRUE, colClasses="character")
colnames(placelist) <-  tolower(names(placelist))
butLast <- function(x){head(x, -1)}
countynameslist <- sapply(strsplit(placelist$county," "), butLast)
placelist$countyname <- sapply(countynameslist , paste, sep=" ")
tail(placelist)
placelist <- read.csv("national_places.txt", sep="|", header = TRUE, colClasses="character")
Encoding(placelist) <- "UTF-8"
Encoding(placelist)
Encoding(placelist$county)
placelist <- read.csv("national_places.txt",
sep="|", header = TRUE,
colClasses="character",
fileEncoding="UTF-8")
tail(placelist)
colnames(placelist) <-  tolower(names(placelist))
butLast <- function(x){head(x, -1)}
countynameslist <- sapply(strsplit(placelist$county," "), butLast)
head(countynameslist)
placelist$countyname <- sapply(countynameslist , paste, sep=" ")
tail(placelist)
head(placelist)
which(placelist$type == "Incorporated Place")
with(placelist$type == "Incorporated Place")
with(placelist, placelist$type == "Incorporated Place")
as.numeric(with(placelist, placelist$type == "Incorporated Place"))
placelist$type <- as.numeric(with(placelist, placelist$type == "Incorporated Place"))
head(placelist)
placelist <- read.csv("national_places.txt",
sep="|", header = TRUE,
colClasses="character",
fileEncoding="UTF-8")
# Transform data
colnames(placelist) <-  tolower(names(placelist))
butLast <- function(x){head(x, -1)}
placelist$countyname <- sapply((sapply(strsplit(placelist$county," "), butLast)) , paste, sep=" ")
head(placelist)
placelist$county <- NULL
head(placelist)
placenamelist  <- strsplit(placelist$placename," ")
factor(placenamelist)
placenamelist
placelist$status  <- (strsplit(placelist$placename," "), lastElement)
placelist$status  <- sapply(strsplit(placelist$placename," "), lastElement)
lastElement <- function(x){x[-1]}
placelist$status  <- sapply(strsplit(placelist$placename," "), lastElement)
head(placelist)
placelist$placename <- sapply((sapply(strsplit(placelist$placename," "), butLast)) , paste, sep=" ")
placelist <- read.csv("national_places.txt",
sep="|", header = TRUE,
colClasses="character",
fileEncoding="UTF-8")
# Transform data
colnames(placelist) <-  tolower(names(placelist))
butLast <- function(x){head(x, -1)}
placelist$countyname <- sapply((sapply(strsplit(placelist$county," "), butLast)) , paste, sep=" ")
placelist$county <- NULL
lastElement <- function(x){x[-1]}
placelist$status  <- sapply(strsplit(placelist$placename," "), lastElement)
placelist$placename <- sapply((sapply(strsplit(placelist$placename," "), butLast)) , paste, sep=" ")
placelist$type <- as.numeric(with(placelist, placelist$type == "Incorporated Place"))
head(placelist)
library(RMySQL)
con <- dbConnect("MySQL",
user='root',
password='root',
dbname='metroatlas',
host='localhost',
unix.sock="/Applications/MAMP/tmp/mysql/mysql.sock")
dbWriteTable(con, name="C_PlaceList_2010", value=md, overwrite=TRUE)
dbWriteTable(con, name="C_PlaceList_2010", value=placelist, overwrite=TRUE)
class(state)
class(placelist$state)
class(placelist$statefp)
class(placelist$placename)
class(placelist$countyname)
class(placelist$status)
placelist <- read.csv("national_places.txt",
sep="|", header = TRUE,
colClasses="character",
fileEncoding="UTF-8")
colnames(placelist) <-  tolower(names(placelist))
butLast <- function(x){head(x, -1)}
placelist$countyname <- as.character(sapply((sapply(strsplit(placelist$county," "), butLast)) , paste, sep=" "))
placelist$county <- NULL
class(placelist$countyname)
dbDisconnect(con)
placelist <- read.csv("national_places.txt",
sep="|", header = TRUE,
colClasses="character",
fileEncoding="UTF-8")
# Transform data
colnames(placelist) <-  tolower(names(placelist))
butLast <- function(x){head(x, -1)}
placelist$countyname <- as.character(sapply((sapply(strsplit(placelist$county," "), butLast)) , paste, sep=" "))
placelist$county <- NULL
lastElement <- function(x){x[-1]}
placelist$status  <- as.character(sapply(strsplit(placelist$placename," "), lastElement))
placelist$placename <- as.character(sapply((sapply(strsplit(placelist$placename," "), butLast)) , paste, sep=" "))
placelist$type <- as.numeric(with(placelist, placelist$type == "Incorporated Place"))
library(RMySQL)
con <- dbConnect("MySQL",
user='root',
password='root',
dbname='metroatlas',
host='localhost',
unix.sock="/Applications/MAMP/tmp/mysql/mysql.sock")
dbWriteTable(con, name="C_PlaceList_2010", value=placelist, overwrite=TRUE)
dbDisconnect(con)
